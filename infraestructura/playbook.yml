- hosts: frontend
  become: yes

  tasks:
    # Instalar apache
  - name: Install apache packages 
    yum:
      name: httpd
      state: present

       # Iniciar apache
  - name: ensure httpd is running
    service:
      name: httpd 
      state: started
      
  - name: Asegurar que selinux este deshabilitado  # Necesario para cambiar el puerto de apache
    selinux: state=permissive policy=targeted

  - name: Asegurar que httpd exponga el puerto correcto
    lineinfile:
      dest: "/etc/httpd/conf/httpd.conf"
      regexp: '^Listen 80$'
      line: 'Listen {{apache_puerto}}'
      state: 'present'
      backrefs: yes

    # Reiniciar apache
  - name: Restart apache 
      name: httpd
      state: restarted

- hosts: desplegar
  become: yes

  tasks:
    # Copiar los archivos